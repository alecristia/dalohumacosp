---
title: "Analyses speech coding over daylong recordings"
output: pdf_document
	toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
reliab_folder="/Users/acristia/Documents/habilis_backup/PROJECTS/1-developing/WACK-all/coded/"

```

## Key research questions

## Basic (not to redo)
getting an idea of difficulty via coding time
for j in ${folder}*/*m1.TextGrid
do
 date=`date -r $j`
 echo $j $date >> ~/Desktop/times.txt
done
```{r get-codtime}
read.table("~/Desktop/times.txt")->x
x$date=as.Date(paste0(x$V4,x$V3,x$V7),format = "%d%b%Y")
x$dt=as.POSIXlt(paste(x$date,x$V5))
x[order(x$dt),]->y
y$dur=as.numeric(as.character(difftime(c(y$dt[-1],NA),y$dt,units="secs")))
hist(y$dur,xlim=c(0,1000),breaks=10000)
y$dur[y$dur>1000]<-NA
y$name=gsub(".*/","",y$V1,perl=T)
y$name=gsub(".TextGrid","",y$name,fixed=T)
write.table(y[c("name","dur","date","dt")],"../derivedFiles/code_dur.txt",row.names=F)
#data.frame(table(x$date))->quant
#quant$order<-row.names(quant)
#cor.test(quant$order,quant$Freq)
#max(quant$order)*7*60/sum(quant$Freq)
#5*7*60/sum(quant$Freq[dim(quant)[1]-4:dim(quant)[1]])
```

```{r create-dataset,eval=FALSE}
csvs=dir(path=reliab_folder,pattern="csv")
all=NULL
empty=NULL
for(thisf in csvs){
  read.csv(paste0(reliab_folder,thisf))->thiscsv
  bits=strsplit(thisf,"_")
  if(dim(thiscsv)[1]>0){
    all=rbind(all,cbind(bits[[1]][1],bits[[1]][4],bits[[1]][5],bits[[1]][6],thiscsv))
  }else{
    empty=rbind(empty,cbind(bits[[1]][1],bits[[1]][4],bits[[1]][5],bits[[1]][6]))
  }
}
names(all)[1:4]<-c("file","start","end","coder")

#minor clean
all$tier_broad=as.character(all$tier)
all$tier_broad=gsub(" ","",all$tier)
all$tier_broad[grep("parl",all$tier_broad)]<-"2parlou+"
all$tier_broad[grep("oi",all$tier_broad)]<-"Loi-fai-2e"
all$tier_broad[all$tier_broad %in% c("C1","C2")]<-"OCH"
all$tier_broad[all$tier_broad %in% c("FA1","FA2")]<-"FA"
all$tier_broad[all$tier_broad %in% c("MA1","MA2")]<-"MA"

all$age=NA
all$age[all$tier_broad %in% c("CHI","OCH")]<-"C"
all$age[all$tier_broad %in% c("FA","MA")]<-"A"

all$parole=NA
all$parole[all$tier_broad %in% c("OCH","FA","MA")]<-"otherSpeech"


all$coder<-gsub(".csv","",all$coder)
all$dur=all$tmax-all$tmin

write.table(all)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
